with test as ( select  001 acc , 'a' case   FROM DUAL UNION
SELECT  001 , 'b'     FROM DUAL UNION
SELECT  001 , 'c'     FROM DUAL UNION
SELECT  002 , 'a'     FROM DUAL UNION
SELECT  002 , 'b'     FROM DUAL UNION
SELECT  003 , 'b'     FROM DUAL UNION
SELECT  003 , 'c'    FROM DUAL UNION
SELECT  004 , 'a'     FROM DUAL UNION
SELECT  005 , 'b'     FROM DUAL UNION
SELECT  006 , 'b'     FROM DUAL UNION
SELECT  007 , 'a'     FROM DUAL UNION
SELECT  007 , 'b'    FROM DUAL UNION
SELECT  007 , 'c'     FROM DUAL UNION
SELECT  008 , 'a'     FROM DUAL UNION
SELECT  008 , 'b'     FROM DUAL )
select case,count(1) from
(
SELECT count(1),acc, LISTAGG(case, '+') WITHIN GROUP (ORDER BY acc) AS case
FROM   test
GROUP BY acc) GROUP BY case order by 1;
