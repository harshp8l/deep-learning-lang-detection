+---------------------+--------+-------+---------------------+-------+----------+
|         dt          | Period | Price |         d2          |  d3   | AvgPrice |
+---------------------+--------+-------+---------------------+-------+----------+
| 2017-12-06 00:00:00 |     39 | 90.00 | 2017-12-06 20:00:00 | 37103 | 90.00    |
| 2017-12-06 00:00:00 |     40 | 90.00 | 2017-12-06 20:30:00 | 37103 | 90.00    |
| 2017-12-06 00:00:00 |     41 | 90.00 | 2017-12-06 21:00:00 | 37103 | 90.00    |
| 2017-12-06 00:00:00 |     42 | 90.00 | 2017-12-06 21:30:00 | 37103 | 90.00    |
| 2017-12-06 00:00:00 |     43 | 90.00 | 2017-12-06 22:00:00 | 37103 | 90.00    |
| 2017-12-06 00:00:00 |     44 | 90.00 | 2017-12-06 22:30:00 | 37103 | 90.00    |
| 2017-12-06 00:00:00 |     45 | 90.00 | 2017-12-06 23:00:00 | 37103 | 90.00    |
| 2017-12-06 00:00:00 |     46 | 90.00 | 2017-12-06 23:30:00 | 37103 | 90.00    |
| 2017-12-06 00:00:00 |     47 | 10.00 | 2017-12-07 00:00:00 | 37104 | 45.00    |
| 2017-12-06 00:00:00 |     48 | 20.00 | 2017-12-07 00:30:00 | 37104 | 45.00    |
| 2017-12-07 00:00:00 |      1 | 30.00 | 2017-12-07 01:00:00 | 37104 | 45.00    |
| 2017-12-07 00:00:00 |      2 | 40.00 | 2017-12-07 01:30:00 | 37104 | 45.00    |
| 2017-12-07 00:00:00 |      3 | 50.00 | 2017-12-07 02:00:00 | 37104 | 45.00    |
| 2017-12-07 00:00:00 |      4 | 60.00 | 2017-12-07 02:30:00 | 37104 | 45.00    |
| 2017-12-07 00:00:00 |      5 | 70.00 | 2017-12-07 03:00:00 | 37104 | 45.00    |
| 2017-12-07 00:00:00 |      6 | 80.00 | 2017-12-07 03:30:00 | 37104 | 45.00    |
| 2017-12-07 00:00:00 |      7 | 10.00 | 2017-12-07 04:00:00 | 37105 | 15.00    |
| 2017-12-07 00:00:00 |      8 | 10.00 | 2017-12-07 04:30:00 | 37105 | 15.00    |
| 2017-12-07 00:00:00 |      9 | 10.00 | 2017-12-07 05:00:00 | 37105 | 15.00    |
| 2017-12-07 00:00:00 |     10 | 10.00 | 2017-12-07 05:30:00 | 37105 | 15.00    |
| 2017-12-07 00:00:00 |     11 | 20.00 | 2017-12-07 06:00:00 | 37105 | 15.00    |
| 2017-12-07 00:00:00 |     12 | 20.00 | 2017-12-07 06:30:00 | 37105 | 15.00    |
| 2017-12-07 00:00:00 |     13 | 20.00 | 2017-12-07 07:00:00 | 37105 | 15.00    |
| 2017-12-07 00:00:00 |     14 | 20.00 | 2017-12-07 07:30:00 | 37105 | 15.00    |
| 2017-12-07 00:00:00 |     15 | 40.00 | 2017-12-07 08:00:00 | 37106 | 35.00    |
| 2017-12-07 00:00:00 |     16 | 40.00 | 2017-12-07 08:30:00 | 37106 | 35.00    |
| 2017-12-07 00:00:00 |     17 | 40.00 | 2017-12-07 09:00:00 | 37106 | 35.00    |
| 2017-12-07 00:00:00 |     18 | 40.00 | 2017-12-07 09:30:00 | 37106 | 35.00    |
| 2017-12-07 00:00:00 |     19 | 30.00 | 2017-12-07 10:00:00 | 37106 | 35.00    |
| 2017-12-07 00:00:00 |     20 | 30.00 | 2017-12-07 10:30:00 | 37106 | 35.00    |
| 2017-12-07 00:00:00 |     21 | 30.00 | 2017-12-07 11:00:00 | 37106 | 35.00    |
| 2017-12-07 00:00:00 |     22 | 30.00 | 2017-12-07 11:30:00 | 37106 | 35.00    |
+---------------------+--------+-------+---------------------+-------+----------+
