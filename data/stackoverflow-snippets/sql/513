DECLARE @T TABLE (dt datetime2(0), Period int, Price money);
INSERT INTO @T VALUES
('2017-12-06', 39, 90),
('2017-12-06', 40, 90),
('2017-12-06', 41, 90),
('2017-12-06', 42, 90),
('2017-12-06', 43, 90),
('2017-12-06', 44, 90),
('2017-12-06', 45, 90),
('2017-12-06', 46, 90),

('2017-12-06', 47, 10),
('2017-12-06', 48, 20),
('2017-12-07',  1, 30),
('2017-12-07',  2, 40),
('2017-12-07',  3, 50),
('2017-12-07',  4, 60),
('2017-12-07',  5, 70),
('2017-12-07',  6, 80),

('2017-12-07',  7, 10),
('2017-12-07',  8, 10),
('2017-12-07',  9, 10),
('2017-12-07', 10, 10),
('2017-12-07', 11, 20),
('2017-12-07', 12, 20),
('2017-12-07', 13, 20),
('2017-12-07', 14, 20),

('2017-12-07', 15, 40),
('2017-12-07', 16, 40),
('2017-12-07', 17, 40),
('2017-12-07', 18, 40),
('2017-12-07', 19, 30),
('2017-12-07', 20, 30),
('2017-12-07', 21, 30),
('2017-12-07', 22, 30);
