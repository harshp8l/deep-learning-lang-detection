SELECT MEMBER.MEMBERID
        , MEMBER.FIRSTNAME
        , MEMBER.SURNAME
        , count(BOOKING.BOOKID) as no_of_bookings
FROM MEMBER 
     inner join MEMBERSHIP
     on MEMBER.MEMBERID = MEMBERSHIP.MEMBERID
     inner join BOOKING
     on MEMBER.MEMBERID = BOOKING.MEMBERID 
WHERE MEMBERSHIP.MEMBERSHIPTYPEID = 3
and BOOKING.DATEBOOKED >= add_months(trunc(sysdate), -12) 
GROUP BY MEMBER.MEMBERID
        , MEMBER.FIRSTNAME
        , MEMBER.SURNAME
    HAVING COUNT(*) >= 5
ORDER BY no_of_bookings desc;
