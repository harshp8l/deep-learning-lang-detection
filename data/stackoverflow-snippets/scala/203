val validNumber = udf{ (xs: Seq[Map[String, String]]) => 
                        xs.map{ x => 
                          if (x(""number"").length < 6) 
                             Map(""number"" -> ""0000"" , ""type"" -> x(""type"")) 
                          else x }
                     }

 df.show(false)
+----+-----------------------------------------------------------------------------+
|name|contact                                                                      |
+----+-----------------------------------------------------------------------------+
|Alan|[Map(number -> 6789, type -> home), Map(number -> 987654321, type -> mobile)]|
+----+-----------------------------------------------------------------------------+


df.select(validNumber($""contact"") ).show(false)
+-----------------------------------------------------------------------------+
|UDF(contact)                                                                 |
+-----------------------------------------------------------------------------+
|[Map(number -> 0000, type -> home), Map(number -> 987654321, type -> mobile)]|
+-----------------------------------------------------------------------------+
