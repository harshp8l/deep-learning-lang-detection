text = File.read(""/home/max/raw_email.txt"")
boundary_line = text.grep(/boundary\=mimepart/).first.chomp
mimepart_divider = ""--#{boundary_line.split(""boundary="").last}""
mimeparts = text.split(mimepart_divider)
mimepart = mimeparts.grep(/application\/pdf/).first
filename = mimepart.grep(/filename\=/).first.chomp.split(""filename="").last
mimedata = mimepart.split(""\n\n"").compact_blank.last
decoded = Base64.decode64(mimedata)
File.open(""#{ENV['HOME']}/#{filename}"",""w""){|f| f.puts decoded}
