df = pd.DataFrame([
    ['2018-04-01 00:00:00', 53.1783, 110.8514, 0.479726, 0], 
    ['2018-04-01 00:30:00', 51.1496, 105.9060, 0.482972, 0], 
    ['2018-04-01 01:00:00', 42.9360, 120.7555, 0.355561, 1], 
    ['2018-04-01 01:30:00', 37.8455, 114.5514, 0.330380, 0], 
    ['2018-04-01 02:00:00', 43.9254, 99.1340,  0.443091, 1]], 
    columns=['datehour', 'pft', 'rev', 'mgn', 'neg'])

df['dsf'] = 0
counter = 0

for i,r in df.iterrows():
    counter += 1
    if r['neg'] != 0:
        df.loc[i, 'dsf'] = counter
        counter = 0

print(df)
#                datehour     pft      rev         mgn   neg      dsf
# 0   2018-04-01 00:00:00 53.1783 110.8514    0.479726    0         0
# 1   2018-04-01 00:30:00 51.1496 105.9060    0.482972    0         0
# 2   2018-04-01 01:00:00 42.9360 120.7555    0.355561    1         3
# 3   2018-04-01 01:30:00 37.8455 114.5514    0.330380    0         0
# 4   2018-04-01 02:00:00 43.9254 99.1340     0.443091    1         2
